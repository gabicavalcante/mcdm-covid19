{
  
    
        "post0": {
            "title": "Country level - Dominance",
            "content": "Collecting plotly Downloading https://files.pythonhosted.org/packages/bf/5f/47ab0d9d843c5be0f5c5bd891736a4c84fa45c3b0a0ddb6b6df7c098c66f/plotly-4.9.0-py2.py3-none-any.whl (12.9MB) |████████████████████████████████| 12.9MB 313kB/s Requirement already satisfied, skipping upgrade: retrying&gt;=1.3.3 in /usr/local/lib/python3.6/dist-packages (from plotly) (1.3.3) Requirement already satisfied, skipping upgrade: six in /usr/local/lib/python3.6/dist-packages (from plotly) (1.15.0) Installing collected packages: plotly Found existing installation: plotly 4.4.1 Uninstalling plotly-4.4.1: Successfully uninstalled plotly-4.4.1 Successfully installed plotly-4.9.0 Collecting plotly-express Downloading https://files.pythonhosted.org/packages/d4/d6/8a2906f51e073a4be80cab35cfa10e7a34853e60f3ed5304ac470852a08d/plotly_express-0.4.1-py2.py3-none-any.whl Requirement already satisfied, skipping upgrade: patsy&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (0.5.1) Requirement already satisfied, skipping upgrade: scipy&gt;=0.18 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (1.4.1) Requirement already satisfied, skipping upgrade: pandas&gt;=0.20.0 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (1.0.5) Requirement already satisfied, skipping upgrade: plotly&gt;=4.1.0 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (4.9.0) Requirement already satisfied, skipping upgrade: statsmodels&gt;=0.9.0 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (0.10.2) Requirement already satisfied, skipping upgrade: numpy&gt;=1.11 in /usr/local/lib/python3.6/dist-packages (from plotly-express) (1.18.5) Requirement already satisfied, skipping upgrade: six in /usr/local/lib/python3.6/dist-packages (from patsy&gt;=0.5-&gt;plotly-express) (1.15.0) Requirement already satisfied, skipping upgrade: pytz&gt;=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas&gt;=0.20.0-&gt;plotly-express) (2018.9) Requirement already satisfied, skipping upgrade: python-dateutil&gt;=2.6.1 in /usr/local/lib/python3.6/dist-packages (from pandas&gt;=0.20.0-&gt;plotly-express) (2.8.1) Requirement already satisfied, skipping upgrade: retrying&gt;=1.3.3 in /usr/local/lib/python3.6/dist-packages (from plotly&gt;=4.1.0-&gt;plotly-express) (1.3.3) Installing collected packages: plotly-express Successfully installed plotly-express-0.4.1 . . Cloning into &#39;mo_covid19&#39;... remote: Enumerating objects: 219, done. remote: Counting objects: 100% (219/219), done. remote: Compressing objects: 100% (135/135), done. remote: Total 219 (delta 125), reused 163 (delta 73), pack-reused 0 Receiving objects: 100% (219/219), 1006.02 KiB | 11.18 MiB/s, done. Resolving deltas: 100% (125/125), done. . /usr/local/lib/python3.6/dist-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead. . . MinMax Scaler . def unit_variance(df, index=[&quot;locality_name&quot;, &quot;n_days_since_restriction&quot;]): df_small_period = df.pivot_table(index=index, columns=[&quot;category&quot;]) from sklearn.preprocessing import StandardScaler scaler = StandardScaler(with_mean=False) df_small_period_scaled = pd.DataFrame( scaler.fit_transform(df_small_period), index=df_small_period.index, columns=df_small_period.columns, ) return df_small_period_scaled.stack().reset_index() . Dominance . sem scaling . def eps_dominates(x1, x2, eps=1e-2): one_dominates_two = np.any(x2 - x1 - eps * x1 &gt;= 0) two_dominates_one = np.any(x1 - x2 - eps * x2 &gt;= 0) return int(one_dominates_two) - int(two_dominates_one) . dominates eps_dominates mean_scalarized . value value value . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Germany 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . Japan 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | 7 | 6 | . South Korea 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | 6 | 7 | . 0.01 0.05 0.1 . value value value . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Canada 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Germany 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 3 | 3 | . Japan 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . South Korea 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 4 | 4 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 4 | 5 | . com scaling (unit variance) . dominates eps_dominates mean_scalarized . value value value . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Germany 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . Japan 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | 7 | 6 | . South Korea 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | 6 | 7 | . dominates eps_dominates mean_scalarized . value value value . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Germany 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . Japan 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | 7 | 6 | . South Korea 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | 6 | 7 | . scaling affects AUC: MA -&gt; Trend | . 0.01 0.05 0.1 . value value value . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Canada 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Germany 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 3 | 3 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 3 | 3 | . Japan 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . South Korea 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 4 | 4 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 4 | 5 | . Cluster #1: as of 0.05, Île-de-France dominates Lombardia | . | Cluster #2: AUC/mean: as of 0.05, SP dominates AM (total order) | RS: at 0.05, SP == AM &lt; NY; at 0.1: rollavg/trend: SP &lt; AM == NY | raw: SP &lt; AM &lt; NY (total order) | . | . | . radar . /usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py:966: SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame. Try using .loc[row_indexer,col_indexer] = value instead See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy . . . /usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py:966: SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame. Try using .loc[row_indexer,col_indexer] = value instead See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy . . . /usr/local/lib/python3.6/dist-packages/pandas/core/indexing.py:966: SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame. Try using .loc[row_indexer,col_indexer] = value instead See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy . . . com janelas . results_complete_10D_depths.loc[&quot;0 days&quot;].sort_values((&quot;dominates&quot;, &quot;auc&quot;, &quot;raw&quot;)).style.set_properties(**df_style).background_gradient(**bg_gradient) . dominates eps_dominates mean_scalarized . agg auc mean rank auc mean rank auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend raw rollavg trend . Argentina 1 | 1 | 2 | 1 | 2 | 1 | 1 | 2 | 1 | 1 | 1 | 2 | 1 | 2 | 1 | 1 | 2 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 1 | 2 | 1 | . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 2 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | 1 | 2 | . Canada 2 | 3 | 4 | 2 | 4 | 3 | 4 | 4 | 2 | 2 | 3 | 4 | 3 | 4 | 3 | 4 | 4 | 2 | 4 | 4 | 6 | 4 | 6 | 4 | 4 | 6 | 4 | . Germany 2 | 2 | 4 | 2 | 4 | 3 | 3 | 4 | 2 | 2 | 3 | 4 | 2 | 4 | 3 | 3 | 4 | 2 | 5 | 5 | 7 | 5 | 7 | 5 | 6 | 7 | 5 | . Spain 2 | 2 | 3 | 2 | 3 | 2 | 3 | 3 | 2 | 2 | 2 | 3 | 2 | 3 | 2 | 3 | 3 | 2 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 4 | 3 | . South Korea 3 | 4 | 3 | 3 | 3 | 4 | 3 | 3 | 2 | 3 | 4 | 3 | 4 | 3 | 4 | 3 | 3 | 2 | 6 | 6 | 4 | 6 | 4 | 6 | 5 | 3 | 5 | . Japan 4 | 4 | 3 | 4 | 3 | 4 | 5 | 3 | 3 | 4 | 5 | 3 | 5 | 4 | 5 | 5 | 3 | 3 | 7 | 7 | 5 | 7 | 5 | 7 | 7 | 5 | 6 | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . Argentina 1 | 1 | 2 | 1 | 2 | 1 | 1 | 2 | 1 | . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Canada 2 | 2 | 3 | 2 | 3 | 2 | 2 | 2 | 2 | . Germany 2 | 2 | 3 | 2 | 3 | 2 | 2 | 3 | 2 | . Spain 2 | 2 | 3 | 2 | 3 | 2 | 2 | 3 | 2 | . South Korea 3 | 3 | 3 | 3 | 3 | 3 | 2 | 3 | 2 | . Japan 4 | 3 | 3 | 4 | 3 | 3 | 3 | 3 | 3 | . array([2, 1, 3, 4]) . regions . Window 40 everybody agrees: Lombardia, Île-de-France, AM == SP, NY | except rank + raw: Lombardia == Île-de-France | . | Window 30 everybody agrees: Lombardia, Île-de-France, AM == SP == NY | . | Window 20 everybody agrees: Lombardia == Île-de-France, AM == SP, NY | except raw: Lombardia == Île-de-France, AM == SP == NY | . | Window 10: two patterns, no explanation pattern 1 (majority): Île-de-France, SP, Lombardia == AM == NY | pattern 2 (minority): Île-de-France, SP, AM == NY, Lombardia | . | Window 0: many patterns most common: Île-de-France == SP, Lombardia == AM == NY | . | . . . 0 days, auc, raw . . . 10 days, auc . . . . .",
            "url": "https://gabicavalcante.github.io/mcdm-covid19/2020/08/26/Post_MO_COVID19_Dominance_Country.html",
            "relUrl": "/2020/08/26/Post_MO_COVID19_Dominance_Country.html",
            "date": " • Aug 26, 2020"
        }
        
    
  
    
        ,"post1": {
            "title": "Region level - data preparation, seasonality and metrics",
            "content": "Filtering, renaming, and aggregating . Inspecting regions . fig = px.line(long_regions, x=&quot;date&quot;, y=&quot;value&quot;, color=&quot;category&quot;, labels=plotly_labels, color_discrete_sequence = colors_sequence_category, facet_col=&quot;locality_name&quot;, facet_col_wrap=2, height=800) fig.show() . . . Data preparation . Enriching with dates . date locality_name retail grocery_pharmacy parks transit_stations workplaces residential first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction . 0 2020-02-15 | Lombardia | 3.076923 | -3.538462 | 42.307692 | 9.615385 | -1.076923 | -0.846154 | 2020-02-14 | 2020-02-23 | 2020-05-04 | 1 | -8 | -79 | . 1 2020-02-15 | New York | 9.096774 | -0.967742 | 16.892857 | 10.625000 | 0.387097 | -0.179487 | 2020-03-01 | 2020-03-15 | 2020-05-15 | -15 | -29 | -90 | . 2 2020-02-15 | Amazonas | -2.857143 | 5.750000 | -19.500000 | -5.333333 | 6.500000 | -1.000000 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -27 | -30 | -106 | . 3 2020-02-15 | São Paulo | 2.424528 | 1.944724 | 2.500000 | 1.007576 | 6.419355 | -0.676647 | 2020-02-26 | 2020-03-16 | 2020-06-01 | -11 | -30 | -107 | . 4 2020-02-15 | Île-de-France | -11.555556 | -10.444444 | 7.333333 | 3.222222 | -8.222222 | -1.222222 | 2020-01-23 | 2020-03-12 | 2020-05-11 | 23 | -26 | -86 | . (-120.0, 220.0) . Filtering using restriction dates (comment if you do not want to do this) . # data_period = data_by_days.query(&quot;n_days_since_restriction &gt;= -7 &amp; n_days_since_restriction &lt;= 50&quot;) . Inspecting . . . Centering the mean . https://support.google.com/covid19-mobility/checklist/9834261?hl=pt-BR&amp;ref_topic=9822927 . locality_name category baseline_mean date first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction value . 0 Amazonas | retail | 0.703413 | 2020-02-15 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -27 | -30 | -106 | -3.560556 | . 1 Amazonas | retail | 0.703413 | 2020-02-16 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -26 | -29 | -105 | -5.370079 | . 2 Amazonas | retail | 0.703413 | 2020-02-17 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -25 | -28 | -104 | 2.796587 | . 3 Amazonas | retail | 0.703413 | 2020-02-18 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -24 | -27 | -103 | 4.796587 | . 4 Amazonas | retail | 0.703413 | 2020-02-19 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -23 | -26 | -102 | -7.303413 | . Inspecting workplaces . . . Inspecting regions . . . Shift to positive . category locality_name date first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction grocery_pharmacy parks residential retail transit_stations workplaces . 0 Amazonas | 2020-02-15 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -27 | -30 | -106 | 115.230256 | 103.757637 | 110.125256 | 108.266368 | 103.813034 | 108.107361 | . 1 Amazonas | 2020-02-16 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -26 | -29 | -105 | 111.813590 | 102.543352 | 112.125256 | 106.456844 | 108.146368 | 101.607361 | . 2 Amazonas | 2020-02-17 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -25 | -28 | -104 | 109.480256 | 123.257637 | 110.375256 | 114.623510 | 109.479701 | 121.829583 | . 3 Amazonas | 2020-02-18 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -24 | -27 | -103 | 107.280256 | 119.007637 | 110.375256 | 116.623510 | 122.146368 | 121.718472 | . 4 Amazonas | 2020-02-19 | 2020-03-13 | 2020-03-16 | 2020-05-31 | -23 | -26 | -102 | 104.080256 | 111.757637 | 110.375256 | 104.523510 | 119.646368 | 120.496250 | . Inspecting workplaces . . . . . Inspecting regions . . . Seasonality . STL . Inspecting workplaces . . . Inspecting regions . . . Rolling avg (7-day) . Inspecting workplaces . . . Inspecting regions . . . Gathering all the data . 0 a 50 days | . Computing metrics . For a single window . locality_name n_days_since_restriction category raw trend rollavg . 246 Lombardia | 0 | retail | 93.057692 | 100.546279 | 108.640110 | . 247 Lombardia | 0 | grocery_pharmacy | 122.615385 | 114.723866 | 113.780220 | . 248 Lombardia | 0 | parks | 101.307692 | 106.839176 | 107.153846 | . 249 Lombardia | 0 | transit_stations | 96.413462 | 91.459244 | 108.237637 | . 250 Lombardia | 0 | workplaces | 109.163462 | 102.137171 | 111.581044 | . ... ... | ... | ... | ... | ... | ... | . 2389 São Paulo | 49 | grocery_pharmacy | 99.872640 | 102.726109 | 97.473127 | . 2390 São Paulo | 49 | parks | 77.980310 | 78.209552 | 78.363070 | . 2391 São Paulo | 49 | transit_stations | 65.747592 | 64.892561 | 63.498957 | . 2392 São Paulo | 49 | workplaces | 83.163505 | 78.607534 | 75.416396 | . 2393 São Paulo | 49 | residential | 126.232208 | 126.911048 | 127.401679 | . 1500 rows × 6 columns . . . Inspecting categories . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Île-de-France 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Lombardia 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . New York 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . São Paulo 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Amazonas 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . regiões . auc e mean tem resultados iguais. rank muda das outras medidas de agregamento somente no raw. | NY esta no ultimo em raw e trend (menos quando é no rank/raw), porém no rollavg ele troca com o Amazonas | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Lombardia 1 | 2 | 1 | 1 | 2 | 1 | 2 | 2 | 2 | . Île-de-France 2 | 1 | 2 | 2 | 1 | 2 | 1 | 1 | 1 | . Amazonas 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . São Paulo 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . New York 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Amazonas 4455.565897 | 4504.655183 | 4477.651070 | 91.350923 | 92.184352 | 91.693439 | 162.0 | 140.0 | 148.0 | . Lombardia 3805.346154 | 3959.912088 | 3784.170761 | 77.512308 | 80.963077 | 77.401843 | 114.0 | 118.0 | 111.0 | . New York 4768.812635 | 4850.637476 | 4771.220309 | 97.747342 | 99.261617 | 97.730099 | 195.0 | 214.0 | 214.0 | . São Paulo 4626.737175 | 4680.498404 | 4641.320726 | 94.664313 | 95.720506 | 94.982894 | 180.0 | 176.0 | 180.0 | . Île-de-France 3842.878205 | 3937.124237 | 3815.090103 | 79.018376 | 80.704090 | 78.292794 | 99.0 | 102.0 | 97.0 | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Lombardia 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 2 | . Île-de-France 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Amazonas 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . São Paulo 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . New York 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . For multiple windows . Inspecting categories . . . n_days_since_restriction category locality_name agg metric value . 0 0 days | grocery_pharmacy | Amazonas | mean | raw | 98.281923 | . 1 0 days | grocery_pharmacy | Lombardia | mean | raw | 109.061538 | . 2 0 days | grocery_pharmacy | New York | mean | raw | 112.354519 | . 3 0 days | grocery_pharmacy | São Paulo | mean | raw | 98.898764 | . 4 0 days | grocery_pharmacy | Île-de-France | mean | raw | 103.829487 | . ... ... | ... | ... | ... | ... | ... | . 1345 40 days | workplaces | Amazonas | auc | rollavg | 654.152935 | . 1346 40 days | workplaces | Lombardia | auc | rollavg | 388.432692 | . 1347 40 days | workplaces | New York | auc | rollavg | 622.775376 | . 1348 40 days | workplaces | São Paulo | auc | rollavg | 688.667587 | . 1349 40 days | workplaces | Île-de-France | auc | rollavg | 410.529609 | . 1350 rows × 6 columns . n_days_since_restriction locality_name agg metric value . 475 0 | Amazonas | rank | raw | 40.0 | . 476 0 | Lombardia | rank | raw | 33.0 | . 477 0 | New York | rank | raw | 24.0 | . 478 0 | São Paulo | rank | raw | 30.0 | . 479 0 | Île-de-France | rank | raw | 23.0 | . ... ... | ... | ... | ... | ... | . 895 40 | Amazonas | rank | rollavg | 40.0 | . 896 40 | Lombardia | rank | rollavg | 10.0 | . 897 40 | New York | rank | rollavg | 30.0 | . 898 40 | São Paulo | rank | rollavg | 50.0 | . 899 40 | Île-de-France | rank | rollavg | 20.0 | . 75 rows × 5 columns . . . . .",
            "url": "https://gabicavalcante.github.io/mcdm-covid19/2020/08/26/MO_Covid19_Region.html",
            "relUrl": "/2020/08/26/MO_Covid19_Region.html",
            "date": " • Aug 26, 2020"
        }
        
    
  
    
        ,"post2": {
            "title": "Country level - data preparation, seasonality and metrics",
            "content": "Filtering, renaming, and aggregating . Inspecting regions . fig = px.line(long_regions, x=&quot;date&quot;, y=&quot;value&quot;, color=&quot;category&quot;, labels=plotly_labels, color_discrete_sequence = colors_sequence_category, facet_col=&quot;locality_name&quot;, facet_col_wrap=2, height=800) fig.show() . . . Data preparation . Enriching with dates . date locality_name retail grocery_pharmacy parks transit_stations workplaces residential first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction . 0 2020-02-15 | Argentina | -0.660436 | -2.574324 | -2.493573 | -1.103774 | 0.444444 | 0.613734 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -18 | -30 | -90 | . 1 2020-02-15 | Canada | 1.500000 | -0.846154 | 4.500000 | 4.000000 | -1.416667 | 0.100000 | 2020-01-26 | 2020-03-16 | 2020-05-15 | 20 | -30 | -90 | . 2 2020-02-15 | Germany | 5.470588 | 1.352941 | 46.647059 | 10.529412 | -0.235294 | -1.000000 | 2020-01-28 | 2020-03-16 | 2020-05-15 | 18 | -30 | -90 | . 3 2020-02-15 | Japan | -0.791667 | 3.270833 | 6.125000 | -1.416667 | 4.270833 | 0.083333 | 2020-01-15 | 2020-03-02 | 2020-05-15 | 31 | -16 | -90 | . 4 2020-02-15 | New Zealand | 6.705882 | 3.470588 | -3.941176 | 3.636364 | 3.352941 | 0.400000 | 2020-02-28 | 2020-03-24 | 2020-05-15 | -13 | -38 | -90 | . # #hide_input # import matplotlib.dates as mdates # id_vars = [&quot;date&quot;, &quot;locality_name&quot;, &quot;first_case_date&quot;, &quot;restriction_date&quot;, &quot;ease_restriction_date&quot;, &quot;n_days_since_first_case&quot;, &quot;n_days_since_restriction&quot;, &quot;n_days_since_ease_restriction&quot;,] # data_to_plot = data_period.melt( # id_vars, # var_name=&quot;category&quot;, # value_name=&quot;value&quot; # ).query(&#39;locality_name==&quot;Lombardia&quot; and category!=&quot;residential&quot; and date &lt;= &quot;2020-07-21&quot;&#39;) # long_regions_plot = sns.relplot( # x=&quot;date&quot;, # y=&quot;value&quot;, # hue=&quot;category&quot;, # data = data_to_plot, # col=&quot;locality_name&quot;, # col_wrap=2, # kind=&quot;line&quot;, # height=6, # legend=&quot;brief&quot;, # aspect=1.5, # markers=True, # dashes=True # ) # long_regions_plot._legend.remove() # # Iterate thorugh each axis # for ax in long_regions_plot.axes: # ax.set(xlabel=&#39;Date&#39;, ylabel=&#39;&#39;) # handles, labels = ax.get_legend_handles_labels() # if handles: # set_labels = [&#39;Retail &amp; Recreation&#39;, &#39;Grocery &amp; Pharmacy&#39;, &#39;Parks&#39;, &#39;Transit Stations&#39;, &#39;Workplaces&#39;] #labels[1:] # ax.legend(handles=handles[1:], labels=set_labels, title=&quot;&quot;, fontsize=11, title_fontsize=11) # # Make x and y-axis labels slightly larger # ax.set_xlabel(ax.get_xlabel(), fontsize=14) # ax.set_ylabel(ax.get_ylabel(), fontsize=14) # # Make title more human-readable and larger # if ax.get_title(): # ax.set_title(&quot;&quot;) # #set ticks every week # ax.xaxis.set_major_locator(mdates.WeekdayLocator()) # #set major ticks format # ax.xaxis.set_major_formatter(mdates.DateFormatter(&#39;%b&#39;)) # ax.xaxis.set_major_locator(mdates.WeekdayLocator(interval=5)) # # Make right ylabel more human-readable and larger # if ax.texts: # # This contains the right ylabel text # txt = ax.texts[0] # ax.text(txt.get_unitless_position()[0], txt.get_unitless_position()[1], # txt.get_text().split(&#39;=&#39;)[1], # transform=ax.transAxes, # va=&#39;center&#39;, # fontsize=&#39;xx-large&#39;) # # Remove the original text # ax.texts[0].remove() # ax.fill_between(data_to_plot.query(&quot;50 &gt; n_days_since_restriction &gt;= 0&quot;)[&quot;date&quot;], -150, 100, color=&quot;gray&quot;, alpha=0.2) # from datetime import datetime # restriction_date = datetime.strptime(&#39;2020-02-23&#39;, &#39;%Y-%m-%d&#39;) # ease_restriction_date = datetime.strptime(&quot;2020-05-11&quot;, &#39;%Y-%m-%d&#39;) # plt.axvline(restriction_date, color=&#39;k&#39;, linestyle=&#39;dashed&#39;, linewidth=1) # plt.axvline(ease_restriction_date, color=&#39;k&#39;, linestyle=&#39;dashed&#39;, linewidth=1) # plt.tick_params(axis=&#39;both&#39;,labelsize=13) # #plt.tick_params(axis=&#39;both&#39;,labelsize=13) # axes = plt.gca() # axes.set_ylim([-120, 220]) . Filtering using restriction dates (comment if you do not want to do this) . # data_period = data_by_days.query(&quot;n_days_since_restriction &gt;= -7 &amp; n_days_since_restriction &lt;= 50&quot;) . Inspecting . . . Centering the mean . https://support.google.com/covid19-mobility/checklist/9834261?hl=pt-BR&amp;ref_topic=9822927 . locality_name category baseline_mean date first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction value . 0 Argentina | retail | -3.140328 | 2020-02-15 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -18 | -30 | -90 | 2.479891 | . 1 Argentina | retail | -3.140328 | 2020-02-16 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -17 | -29 | -89 | -3.145387 | . 2 Argentina | retail | -3.140328 | 2020-02-17 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -16 | -28 | -88 | -5.801453 | . 3 Argentina | retail | -3.140328 | 2020-02-18 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -15 | -27 | -87 | 2.086456 | . 4 Argentina | retail | -3.140328 | 2020-02-19 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -14 | -26 | -86 | 2.728367 | . Inspecting workplaces . . . Inspecting regions . . . Shift to positive . category locality_name date first_case_date restriction_date ease_restriction_date n_days_since_first_case n_days_since_restriction n_days_since_ease_restriction grocery_pharmacy parks residential retail transit_stations workplaces . 0 Argentina | 2020-02-15 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -18 | -30 | -90 | 101.009766 | 108.606217 | 104.536025 | 107.090657 | 106.541071 | 98.361359 | . 1 Argentina | 2020-02-16 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -17 | -29 | -89 | 98.154226 | 98.835687 | 106.062832 | 101.465379 | 103.259478 | 94.655010 | . 2 Argentina | 2020-02-17 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -16 | -28 | -88 | 96.982783 | 92.192686 | 105.113302 | 98.809313 | 102.950400 | 106.695951 | . 3 Argentina | 2020-02-18 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -15 | -27 | -87 | 103.860757 | 103.603855 | 103.664828 | 106.697222 | 108.022835 | 108.118032 | . 4 Argentina | 2020-02-19 | 2020-03-04 | 2020-03-16 | 2020-05-15 | -14 | -26 | -86 | 102.495274 | 113.031109 | 102.507476 | 107.339133 | 110.314747 | 110.191200 | . Inspecting workplaces . . . . . Inspecting regions . . . Seasonality . STL . Inspecting workplaces . . . Inspecting regions . . . Rolling avg (7-day) . Inspecting workplaces . . . Inspecting regions . . . Gathering all the data . 0 a 50 days | . Computing metrics . For a single window . locality_name n_days_since_restriction category raw trend rollavg . 324 South Korea | 0 | retail | 87.396480 | 93.735825 | 101.896480 | . 325 South Korea | 0 | grocery_pharmacy | 102.110766 | 102.369143 | 103.896480 | . 326 South Korea | 0 | parks | 80.182195 | 104.524544 | 99.967909 | . 327 South Korea | 0 | transit_stations | 90.039337 | 96.950928 | 102.253623 | . 328 South Korea | 0 | workplaces | 101.110766 | 100.736372 | 104.039337 | . ... ... | ... | ... | ... | ... | ... | . 3679 New Zealand | 49 | grocery_pharmacy | 75.113552 | 79.692980 | 75.894505 | . 3680 New Zealand | 49 | parks | 62.774659 | 66.995170 | 64.791466 | . 3681 New Zealand | 49 | transit_stations | 41.109065 | 46.787932 | 39.654519 | . 3682 New Zealand | 49 | workplaces | 59.896112 | 66.146694 | 61.089389 | . 3683 New Zealand | 49 | residential | 123.903850 | 120.506430 | 123.149881 | . 2100 rows × 6 columns . . . Inspecting categories . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . New Zealand 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Spain 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . Argentina 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Germany 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . South Korea 6 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | . Japan 7 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | . regiões . auc e mean tem resultados iguais. rank muda das outras medidas de agregamento somente no raw. | NY esta no ultimo em raw e trend (menos quando é no rank/raw), porém no rollavg ele troca com o Amazonas | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . New Zealand 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Germany 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . Japan 6 | 6 | 6 | 6 | 6 | 6 | 6 | 7 | 6 | . South Korea 7 | 7 | 7 | 7 | 7 | 7 | 7 | 6 | 7 | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Argentina 3084.461562 | 3217.346131 | 3120.327611 | 63.514851 | 66.101026 | 64.116372 | 117.0 | 116.0 | 112.0 | . Canada 3948.183713 | 4053.067829 | 3962.663104 | 81.064985 | 83.064366 | 81.246660 | 207.0 | 219.0 | 209.0 | . Germany 4272.021164 | 4345.311342 | 4284.566819 | 87.603658 | 88.897261 | 87.687527 | 241.0 | 241.0 | 242.0 | . Japan 5035.967901 | 5065.903913 | 5041.734693 | 102.717797 | 103.400238 | 102.876497 | 297.0 | 304.0 | 312.0 | . New Zealand 3124.513333 | 3234.757311 | 3172.424780 | 64.343361 | 66.567647 | 65.143137 | 127.0 | 119.0 | 115.0 | . agg auc mean rank . metric raw rollavg trend raw rollavg trend raw rollavg trend . locality_name . Spain 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | . Argentina 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | . New Zealand 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | 3 | . Canada 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | . Japan 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | 5 | . Germany 6 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | 6 | . South Korea 7 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | 7 | . For multiple windows . Inspecting categories . . . n_days_since_restriction category locality_name agg metric value . 0 0 days | grocery_pharmacy | Argentina | mean | raw | 67.885324 | . 1 0 days | grocery_pharmacy | Canada | mean | raw | 94.523587 | . 2 0 days | grocery_pharmacy | Germany | mean | raw | 92.620570 | . 3 0 days | grocery_pharmacy | Japan | mean | raw | 102.334464 | . 4 0 days | grocery_pharmacy | New Zealand | mean | raw | 63.542964 | . ... ... | ... | ... | ... | ... | ... | . 1885 40 days | workplaces | Germany | auc | rollavg | 682.952357 | . 1886 40 days | workplaces | Japan | auc | rollavg | 835.649052 | . 1887 40 days | workplaces | New Zealand | auc | rollavg | 516.001981 | . 1888 40 days | workplaces | South Korea | auc | rollavg | 873.639752 | . 1889 40 days | workplaces | Spain | auc | rollavg | 380.769447 | . 1890 rows × 6 columns . n_days_since_restriction locality_name agg metric value . 665 0 | Argentina | rank | raw | 28.0 | . 666 0 | Canada | rank | raw | 30.0 | . 667 0 | Germany | rank | raw | 41.0 | . 668 0 | Japan | rank | raw | 67.0 | . 669 0 | New Zealand | rank | raw | 10.0 | . ... ... | ... | ... | ... | ... | . 1255 40 | Germany | rank | rollavg | 50.0 | . 1256 40 | Japan | rank | rollavg | 60.0 | . 1257 40 | New Zealand | rank | rollavg | 24.0 | . 1258 40 | South Korea | rank | rollavg | 70.0 | . 1259 40 | Spain | rank | rollavg | 10.0 | . 105 rows × 5 columns . . . . .",
            "url": "https://gabicavalcante.github.io/mcdm-covid19/2020/08/26/MO_Covid19_Country.html",
            "relUrl": "/2020/08/26/MO_Covid19_Country.html",
            "date": " • Aug 26, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This is where you put the contents of your About page. Like all your pages, it’s in Markdown format. . This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://gabicavalcante.github.io/mcdm-covid19/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://gabicavalcante.github.io/mcdm-covid19/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}